RewriteEngine On
RewriteBase /tour-and-travel/

# Exclude admin folder from ALL rewrite rules
RewriteRule ^admin/ - [L,NC]

# Remove trailing slash
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)/$ /$1 [R=301,L]

# Hide .php extension (only for frontend)
RewriteCond %{REQUEST_FILENAME}.php -f
RewriteCond %{REQUEST_URI} !^/touristdriversindiaprivatetours/admin/
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# SEO Friendly URL for package detail - /package/slug or /package/id
RewriteRule ^package/([a-zA-Z0-9-]+)/?$ package-detail.php?slug=$1 [NC,L]
RewriteRule ^package/([0-9]+)/?$ package-detail.php?id=$1 [NC,L]

# SEO Friendly URL for tour packages by category - /tours/category-slug
RewriteRule ^tours/([a-zA-Z0-9-]+)/?$ tour-packages.php?category_slug=$1 [NC,L]

# SEO Friendly URL for vehicle detail - /vehicle/slug or /vehicle/id
RewriteRule ^vehicle/([a-zA-Z0-9-]+)/?$ vehicle-detail.php?slug=$1 [NC,L]
RewriteRule ^vehicle/([0-9]+)/?$ vehicle-detail.php?id=$1 [NC,L]

# Redirect .php extension to non-.php (only for frontend, not admin)
RewriteCond %{THE_REQUEST} ^GET\ /[^?\s]+\.php
RewriteCond %{REQUEST_URI} !^/touristdriversindiaprivatetours/admin/
RewriteRule (.*)\.php$ /$1 [R=301,L]

# Security - Prevent access to sensitive files
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>

# Prevent directory browsing
Options -Indexes

# Custom Error Pages
ErrorDocument 404 /touristdriversindiaprivatetours/404.html
ErrorDocument 403 /touristdriversindiaprivatetours/403.html
ErrorDocument 500 /touristdriversindiaprivatetours/500.html

# Enable compression
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>

# Browser caching
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType text/html "access plus 1 hour"
</IfModule>
